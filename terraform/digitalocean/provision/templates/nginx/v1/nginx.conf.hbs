# generated by verwalter {{ verwalter_version }}


{{#each full_schedule.roles}}

    # ------------- ROLE: {{ @key }} -----------------

    {{#if nginx_hosts}}
        {{#each nginx_hosts}}

            server {
                listen 80;
                server_name .{{ name }};

                location / {
                    proxy_http_version 1.1;
                    proxy_set_header Host      $host;
                    proxy_set_header X-Forwarded-For $remote_addr;
                    proxy_set_header X-Forwarded-Proto $scheme;
                    proxy_set_header Upgrade $http_upgrade;
                    proxy_set_header Connection $connection_upgrade;
                    proxy_pass http://mglawica-{{ name }};
                }
            }

            upstream mglawica-{{ name }} {
                {{#each targets }}
                    server {{ host }}:{{ port }};
                {{/each}}
            }

        {{/each}}
    {{/if}}


{{/each}}
